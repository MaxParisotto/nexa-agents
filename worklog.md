# Worklog

## 2/24/2025

- Updated `src/components/Layout/DashboardLayout.js` to add `onClick` handler to the navigation buttons. This fixes the issue where the navbar buttons were not working.
- Incorporated React Flow into the `Agents.js` component to create a basic drag-and-drop visual programming interface.
- Updated `Agents.js` to use the `reactflow` package instead of `react-flow-renderer`.
- Enriched the agent nodes in `src/components/Agents.js` by adding input fields for agent name, description, API address, model temperature, and repetition penalty, as well as a dropdown menu for selecting the inference API (LM Studio or Ollama).
- Implemented a wizard-like popup for configuring agent nodes when clicking an "Add Node" button.
- Added a settings page with input fields for LM Studio and Ollama addresses, and implemented local storage to persist these settings.
- Updated `App.js` and `DashboardLayout.js` to include a route and navigation link to the settings page.
- Updated `Agents.js` and `NodeConfigurationWizard.js` to retrieve and use the server addresses from local storage.
- Added automatic model fetch and a selector for the default model to be used in the settings page.
- Implemented a site-wide chat widget where the user can pick the server, model, and try it out.
- Modified the settings page to have separate default model selectors for LM Studio and Ollama.
- Made the chat widget resizable, movable, and collapsible using `react-resizable` and `react-draggable`.
- Updated the chat widget to use the correct default model based on the selected server.
- Made the web UI accessible over the network by:
  - Configuring the client to bind to 0.0.0.0
  - Updating CORS settings to accept connections from any origin
  - Configuring the server to listen on all network interfaces (0.0.0.0)
  - Updated WebSocket service to use the correct server hostname
- Fixed findDOMNode deprecation warning in the chat widget by using refs with react-draggable
- Fixed WebSocket connection issues by:
  - Updating WebSocket service to accept server URL parameter
  - Passing correct server URL from App.js based on current hostname
  - Updated Socket.IO and Express CORS configuration to properly handle cross-origin requests
  - Added credentials support to both Socket.IO and Express CORS configuration
- Fixed CORS issues with external services (LM Studio and Ollama) by:
  - Added proxy endpoints in the server to handle requests to external services
  - Updated Settings and ChatWidget components to use proxy endpoints
  - Added proper error handling for failed model fetching
  - Added Content-Type headers for proxy requests
- Fixed CORS issues in proxy endpoints by:
  - Added explicit CORS headers for preflight requests
  - Configured proper Access-Control-Allow-Origin headers
  - Added error handling for CORS preflight requests
- Fixed Socket.IO CORS issue by:
  - Updated CLIENT_URL in .env to allow connections from <http://192.168.1.150:3000>
  - Enhanced CORS configuration in server to properly handle credentials
  - Added explicit CORS settings for both Socket.IO and Express middleware
- Implemented detailed settings management system:
  - Created Redux actions and reducer for settings management
  - Added settings state to store with localStorage persistence
  - Implemented comprehensive Settings component with:
    - Input fields for LM Studio and Ollama API URLs
    - Automatic model fetching when URLs change
    - Default model selection dropdowns
    - Form validation and error handling
    - Loading states and error feedback
    - Save functionality with validation
- Fixed CORS and API proxy issues:
  - Updated WebSocket service to use current window location for server URL
  - Added proxy endpoints in server for LM Studio and Ollama API calls
  - Updated settings actions to use proxy endpoints instead of direct API calls
  - Enhanced CORS configuration to accept connections from any origin
  - Added proper error handling for proxy requests
  - Installed axios for server-side API requests
- Implemented comprehensive logging system:
  - Created Redux actions and reducer for log management
  - Added log filtering by level, category, date range, and search
  - Implemented detailed Logs component with:
    - Expandable log entries
    - Color-coded log levels
    - Multiple filter options
    - Search functionality
    - Clear logs option
  - Added Logs page to navigation
  - Installed @mui/x-date-pickers and date-fns for date filtering
- Fixed development environment issues:
  - Installed specific date-fns version (2.30.0) to resolve compatibility issues
  - Added environment configuration for WebSocket development server
  - Updated client start script to use correct WebSocket host and port
  - Added proper CORS configuration for devtunnel access
- Fixed WebSocket and CORS issues:
  - Updated server CORS configuration to accept specific origins
  - Added pre-flight CORS handling for all routes
  - Enhanced Socket.IO configuration with proper transport options
  - Updated WebSocket client to use correct server URL based on client IP
  - Added detailed connection logging for debugging
  - Removed proxy endpoints to simplify architecture
  - Updated settings actions to call LM Studio and Ollama APIs directly
  - Added CORS headers to direct API calls
  - Updated ChatWidget to use direct API calls with proper headers
